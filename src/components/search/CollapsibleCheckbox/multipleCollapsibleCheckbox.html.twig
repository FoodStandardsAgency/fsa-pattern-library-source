{% set spaceless_title = title|replace({" ": ""}) %}
{% set description_id = "accordion__description--" ~ spaceless_title %}
{% set fields_id = "accordion__fields--" ~ spaceless_title %}
<fieldset class="accordion{{ fields is empty or fields is not defined ? " accordion--hidden" : "" }}" aria-describedby="{{ description_id }}" data-name="{{ name }}">
  <legend class="accordion__legend">
    <button class="accordion__button {{ open ? "accordion__button--expanded" : ""}}" aria-expanded={{ open ? "true" : "false"}} aria-controls={{ fields_id }}>
      <span class="accordion__title-text">{{ title }}</span>
    </button>
  </legend>
  <p class="accordion__description" id={{ description_id }} data-selected={{ selected }}></p>
  <div class="accordion__fields {{ open ? "accordion__fields--active" : ""}}" id={{ fields_id }}>
    {% for field in fields %}
      {% if field.results > 0 %}
        <div class="accordion__field">
          <input class="accordion__input" type="checkbox" id="{{ field.id }}" name="{{ name ~ '[' ~ field.value ~ ']' }}" value="{{ field.value }}" {{ field.checked }}>
          <label class="accordion__label" for="{{ field.id }}">{{ field.label }} ({{ field.results }})</label>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</fieldset>

<fieldset class="accordion{{ fields is empty or fields is not defined ? " accordion--hidden" : "" }}" aria-describedby="{{ description_id }}1" data-name="{{ name_one }}">
  <legend class="accordion__legend">
    <button class="accordion__button {{ open ? "accordion__button--expanded" : ""}}" aria-expanded={{ open ? "true" : "false"}} aria-controls="{{ fields_id }}1">
      <span class="accordion__title-text">{{ title_one }}</span>
    </button>
  </legend>
  <p class="accordion__description" id="{{ description_id }}1" data-selected={{ selected }}></p>
  <div class="accordion__fields {{ open ? "accordion__fields--active" : ""}}" id="{{ fields_id }}1">
    {% for field in fields_one %}
      {% if field.results > 0 %}
        <div class="accordion__field">
          <input class="accordion__input" type="checkbox" id="{{ field.id }}1" name="{{ name_one ~ '[' ~ field.value ~ ']' }}" value="{{ field.value }}" {{ field.checked }}>
          <label class="accordion__label" for="{{ field.id }}1">{{ field.label }} ({{ field.results }})</label>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</fieldset>

<fieldset class="accordion{{ fields is empty or fields is not defined ? " accordion--hidden" : "" }}" aria-describedby="{{ description_id }}2" data-name="{{ name_two }}">
  <legend class="accordion__legend">
    <button class="accordion__button {{ open ? "accordion__button--expanded" : ""}}" aria-expanded={{ open ? "true" : "false"}} aria-controls="{{ fields_id }}2">
      <span class="accordion__title-text">{{ title_two }}</span>
    </button>
  </legend>
  <p class="accordion__description" id="{{ description_id }}2" data-selected={{ selected }}></p>
  <div class="accordion__fields {{ open ? "accordion__fields--active" : ""}}" id="{{ fields_id }}2">
    {% for field in fields_two %}
      {% if field.results > 0 %}
        <div class="accordion__field">
          <input class="accordion__input" type="checkbox" id="{{ field.id }}2" name="{{ name_two ~ '[' ~ field.value ~ ']' }}" value="{{ field.value }}" {{ field.checked }}>
          <label class="accordion__label" for="{{ field.id }}2">{{ field.label }} ({{ field.results }})</label>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</fieldset>
